## 原码、反码、补码及位运算符的用法

> 这一部分是自学习C语言来都没彻底搞懂的，而这对理解计算机的基本运算原理有很大帮助，故有本篇

### 一、原码、反码、补码

#### 1. 机器数和真值

- 机器数：**一个数在计算机中的二进制表示形式，叫做这个数的机器数。**机器数是带符号的，最高位为符号位，1为正，0为负。比如+5，机器数是00000101。
- 真值：因为第一位是符号位，所以为区别起见，**将带符号位的机器数对应的真正数值称为机器数的真值**，例如：1000 0001（该机器数的真值 = -000 0001 = -1）

#### 2. 原码、反码、补码的基础概念和计算方法

- 原码：**原码就是符号位加上真值的绝对值**。8位二进制数的取值范围是【1111 1111, 0111 1111】，即【-127，127】。
- 反码：**正数的反码就是本身，负数在原码基础上，符号位不变，其余位取反**。可见反码表示的是一个负数。
- 补码：**正数的补码是本身，负数在原码基础上，符号位不变，其余位取反，最后加1**。

#### 3. 为什么要使用原码、反码、补码

​	有了补码，可以让机器只有加法，而不必设计减法，这样可以让计算机运算的设计就更简单了

> 1 - 1 = 1 + (-1) = [0000 0001]原 + [1000 0001]原 = [1000 0010]原 = -2（错误）
>
> 1 - 1 = 1 + (-1) = [0000 0001]反 + [1111 1110]反 = [1111 1111]反 = [1000 0000]原 = -0（部分正确）
>
> 1 - 1 = 1 + (-1) = [0000 0001]补 + [1111 1111]补 = [0000 0000]补 = [0000 0000]原 = 0（正确）

​	反码其实没什么用，更多是为了引出补码。

#### 4. 原码、反码、补码再深入

​	假设我们有正数0000 0000 0000 1111，我们如何表示其相反数呢？一般我们的思路是，找一个数，跟它相加的结果等于0，但这还是要思考一下的，因为要计算进位，所以为什么不找出一个与它相加结果是1111 1111 1111 1111的数呢，然后加1就是我们需要的结果。于是

> 0000 0000 0000 1111 + 1111 1111 1111 0000 + 1 = 1111 1111 1111 1111 + 1 = （1）0000 0000 0000 0000

​	首先，找出一个一个数与它加起来全是1的，这就是它的反码，然后加1，这便是它的相反数了，也就是我们说的补码。

​	我们可以检验一下0的情况：

> 0000 + 1111 + 1 = （1）0000，其中1111 + 1 = （1）0000，即+0和-0的二进制表示均为0000

### 二、位运算

> 位运算符主要是以二进制规则进行运算

#### 1. 与（&）运算符

使用规则：两个二进制操作数**对应位同为1结果位为1，其余为0**。

> 例如：(15 & 127) = (0000 1111) & (0111 1111) = (0000 1111) = 15

#### 2. 或（|）运算符

使用规则：两个二进制操作数**对应位只要有一个为1结果位就为1，其余为0**。

> 例如：(127 | 128) = (0111 1111) | (1000 0000) = (1111 1111) = 255

#### 3. 非（~）运算符

使用规则：一个二进制操作数，**对应位为0，结果位为1；对应位为1，结果位为0**。

> 例如：(~0000 0001) = (1111 1110) 这是内存中的保存形式

我们读取的十进制是根据原码来读取，而在内存中，数值是以二进制补码形式存储的。

> 所以：(1111 1110) = (1000 0001)反码 = (1000 0011)补码 = -2
>
> ~(1) = -2

#### 4. 异或（^）运算符

使用规则：两个二进制操作数**对应位相同为0，不同为1**。

> 例如：(2 ^ 3) = (0000 0010) ^ (0000 0011) = (0000 0001)

#### 5. 移位运算（<< 和 >>）

​	移位运算符组成的表达式也属于算法表达式，其值为算术值。左移运算是将一个二进制位的操作数按指定的移动的位数向左移动，移出位被丢弃，右边移出的空位一律补0。右移运算除了补0之外，可以补符号位，这由不同的机器决定。

##### 5.1 左移（<<）运算符

语法格式：**需要移位的数字number << 移位的次数**

> 例如：10 << 2  --->  (0000 1010) << 2 = (0010 1000) = 40

数学意义：**在数字没有溢出的前提下，对于正数和负数，左移一位都相当于乘以2的1次方，左移n位就相当于乘以2的n次方。**

##### 5.2 右移（>>）运算符

语法格式：**需要移位的数字number >> 移位的次数**

> 例如：(-7) >> 2（这里计算负数的右移运算，正数高位直接补0就行）
>
> (-7) = (1000 0111)原 = (1111 1000)反 = (1111 1001)补 -->（右移两位，补符号位） = (1111 1110)补 = (1000 0001)反 = (1000 0010)补 = -2

数学意义：**在数字没有溢出的前提下，对于正数和负数，右移一位都相当于除以2的1次方，左移n位就相当于除以2的n次方。**